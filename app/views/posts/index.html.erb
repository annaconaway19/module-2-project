<%= render partial: "layouts/navbar" %>

<body>
  <div class="post-index">
    <link rel="stylesheet" href="app/assets/stylesheets/posts.scss">
    <%= form_tag posts_path, method: :get do %>
      <%= label_tag 'search_by', 'Search By: ' %>
      <%= select_tag 'search_by', options_for_select([ 'Cocktail', 'Flavor' ], 'Cocktail') %>

      <%= label_tag 'search_term', 'Search: ' %>
      <%= text_field_tag 'search_term', nil, list: "flavors_autocomplete" %>

        <datalist id='flavors_autocomplete'>
          <% Flavor.all.each do |flavor| %>
            <option value="<%= flavor.keyword.capitalize %>"></option>
          <% end %>

        </datalist>

      <%= label_tag 'sort_by', 'Sort By: ' %>
      <%= select_tag 'sort_by', options_for_select([ 'Newest Posts', 'Oldest Posts', 'Most Likes', 'Least Likes' ], 'Newest Posts') %>

      <%= submit_tag 'Search'%>
    <% end %>

    <% @posts.each do |post| %>
      <div style="border: 1px solid black; float: left">
        <h2><%= link_to post.cocktail.name, post %></h2>
        <img src="<%= post.image_url %>" style="width: 200px">
        <h4><%= post.flavors[0].keyword %></h4>
        <h4><%= post.flavors[1].keyword %></h4>
        <p><%= (post.likes.count) == 1 ? 'Like' : 'Likes'%></p>
            <% pre_like = post.likes.find { |like| like.liker_id == current_user.id} %>
              <% if pre_like %>
            <%= button_to 'Unlike', post_like_path(post, pre_like), method: :delete %>
              <% else %>
            <%= button_to 'Like', post_likes_path(post), method: :post %>
              <% end %>
            <%end%>
          </div>


    </div>

  </body>
</html>
